from os.path import join
include: join("rules/init.smk")
include: join("rules/align.smk")
include: join("rules/qc.smk")
include: join("rules/peakcall.smk")
localrules: all
rule all:
    input:
        #trim
        expand(join(RESULTSDIR,"tmp","trim","{sample}.R1.trim.fastq.gz"),sample=SAMPLES),
        #removeBL
        expand(join(RESULTSDIR,"tmp","trim","{sample}.R1.noBL.fastq.gz"),sample=SAMPLES),
        #align
        expand(join(RESULTSDIR,"tagAlign","{sample}.tagAlign.gz"),sample=SAMPLES),
        expand(join(RESULTSDIR,"QC","{sample}.bowtie2.bam.flagstat"),sample=SAMPLES),
        expand(join(RESULTSDIR,"QC","{sample}.dedup.bam.flagstat"),sample=SAMPLES),
        expand(join(RESULTSDIR,"QC","{sample}.filt.bam.flagstat"),sample=SAMPLES),
        expand(join(RESULTSDIR,"QC","{sample}.dupmetric"),sample=SAMPLES),
        expand(join(RESULTSDIR,"QC","preseq","{sample}.nrf"),sample=SAMPLES),
        #nreads stats
        expand(join(RESULTSDIR,"QC","{sample}.nreads.txt"),sample=SAMPLES),
        #fastqc
        expand(join(RESULTSDIR,"QC","fastqc","{sample}.R1_fastqc.zip"), sample=SAMPLES),
        expand(join(RESULTSDIR,"QC","fastqc","{sample}.R2_fastqc.zip"), sample=SAMPLES),
        expand(join(RESULTSDIR,"QC","fastqc","{sample}.R1.noBL_fastqc.zip"), sample=SAMPLES),
        expand(join(RESULTSDIR,"QC","fastqc","{sample}.R2.noBL_fastqc.zip"), sample=SAMPLES), 
        #tss
        expand(join(RESULTSDIR,"QC","tss","{sample}.tss.txt"),sample=SAMPLES),
        #macs2 peaks
        expand(join(RESULTSDIR,"peaks","macs2","{grp}.consensus.macs2.peakfiles"),grp=GROUPS),
        expand(join(RESULTSDIR,"peaks","macs2","{grp}.replicate.macs2.peakfiles"),grp=GROUPS),
        expand(join(RESULTSDIR,"peaks","macs2","{grp}.macs2.tn5nicksbedfiles"),grp=GROUPS)




